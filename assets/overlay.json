{
    "overlay": "1.0.0",
    "info": {
        "title": "Fix OpenAPI spec validation errors for all the FalAI models",
        "version": "1.0.0"
    },
    "actions": [
        {
            "target": "$.components.schemas.Content.properties.role",
            "remove": true
        },
        {
            "target": "$.components.schemas",
            "update": {
                "Role": {
                    "type": "string",
                    "enum": [
                        "user",
                        "model"
                    ]
                },
                "ModelID": {
                    "type": "string",
                    "description": "Unique identifier for a Gemini model variant.",
                    "enum": [
                        "gemini-2.5-flash-preview-05-20",
                        "gemini-2.5-flash-preview-native-audio-dialog",
                        "gemini-2.5-flash-exp-native-audio-thinking-dialog",
                        "gemini-2.5-flash-preview-tts",
                        "gemini-2.5-pro-preview-06-05",
                        "gemini-2.5-pro-preview-tts",
                        "gemini-2.0-flash",
                        "gemini-2.0-flash-preview-image-generation",
                        "gemini-2.0-flash-lite",
                        "gemini-1.5-flash",
                        "gemini-1.5-flash-8b",
                        "gemini-1.5-pro",
                        "gemini-embedding-exp",
                        "imagen-3.0-generate-002",
                        "veo-2.0-generate-001",
                        "gemini-2.0-flash-live-001"
                    ]
                },
                "TextPart": {
                    "type": "object",
                    "properties": {
                        "text": {
                            "type": "string",
                            "description": "Inline text."
                        }
                    },
                    "required": [
                        "text"
                    ]
                },
                "InlineDataPart": {
                    "type": "object",
                    "properties": {
                        "inlineData": {
                            "description": "Inline media bytes.",
                            "$ref": "#/components/schemas/Blob"
                        }
                    },
                    "required": [
                        "inlineData"
                    ]
                },
                "FunctionCallPart": {
                    "type": "object",
                    "properties": {
                        "functionCall": {
                            "description": "A predicted `FunctionCall` returned from the model that contains\na string representing the `FunctionDeclaration.name` with the\narguments and their values.",
                            "$ref": "#/components/schemas/FunctionCall"
                        }
                    },
                    "required": [
                        "functionCall"
                    ]
                },
                "FunctionResponsePart": {
                    "type": "object",
                    "properties": {
                        "functionResponse": {
                            "description": "The result output of a `FunctionCall` that contains a string\nrepresenting the `FunctionDeclaration.name` and a structured JSON\nobject containing any output from the function is used as context to\nthe model.",
                            "$ref": "#/components/schemas/FunctionResponse"
                        }
                    },
                    "required": [
                        "functionResponse"
                    ]
                },
                "FileDataPart": {
                    "type": "object",
                    "properties": {
                        "fileData": {
                            "description": "URI based data.",
                            "$ref": "#/components/schemas/FileData"
                        }
                    },
                    "required": [
                        "fileData"
                    ]
                },
                "ExecutableCodePart": {
                    "type": "object",
                    "properties": {
                        "executableCode": {
                            "description": "Code generated by the model that is meant to be executed.",
                            "$ref": "#/components/schemas/ExecutableCode"
                        }
                    },
                    "required": [
                        "executableCode"
                    ]
                },
                "CodeExecutionResultPart": {
                    "type": "object",
                    "properties": {
                        "codeExecutionResult": {
                            "description": "Result of executing the `ExecutableCode`.",
                            "$ref": "#/components/schemas/CodeExecutionResult"
                        }
                    },
                    "required": [
                        "codeExecutionResult"
                    ]
                },
                "VideoMetadataPart": {
                    "type": "object",
                    "properties": {
                        "videoMetadata": {
                            "description": "Video metadata.",
                            "$ref": "#/components/schemas/VideoMetadata"
                        }
                    },
                    "required": [
                        "videoMetadata"
                    ]
                },
                "ThoughtSignaturePart": {
                    "type": "object",
                    "properties": {
                        "thoughtSignature": {
                            "type": "string",
                            "format": "byte",
                            "description": "Optional. An opaque signature for the thought so it can be reused in subsequent\nrequests."
                        }
                    }
                },
                "Part": {
                    "type": "object",
                    "description": "A datatype containing media that is part of a multi-part `Content` message.\n\nA `Part` consists of data which has an associated datatype. A `Part` can only\ncontain one of the accepted types in `Part.data`.\n\nA `Part` must have a fixed IANA MIME type identifying the type and subtype\nof the media if the `inline_data` field is filled with raw bytes.",
                    "oneOf": [
                        {
                            "$ref": "#/components/schemas/TextPart"
                        },
                        {
                            "$ref": "#/components/schemas/InlineDataPart"
                        },
                        {
                            "$ref": "#/components/schemas/FunctionCallPart"
                        },
                        {
                            "$ref": "#/components/schemas/FunctionResponsePart"
                        },
                        {
                            "$ref": "#/components/schemas/FileDataPart"
                        },
                        {
                            "$ref": "#/components/schemas/ExecutableCodePart"
                        },
                        {
                            "$ref": "#/components/schemas/CodeExecutionResultPart"
                        },
                        {
                            "$ref": "#/components/schemas/ThoughtSignaturePart"
                        },
                        {
                            "$ref": "#/components/schemas/VideoMetadataPart"
                        }
                    ]
                }
            }
        },
        {
            "target": "$.components.schemas.Content.properties",
            "update": {
                "role": {
                    "$ref": "#/components/schemas/Role"
                }
            }
        },
        {
            "target": "$.paths[\"/v1beta/models/{model}:streamGenerateContent\"].post.responses.default.content",
            "remove": true
        },
        {
            "target": "$.paths[\"/v1beta/models/{model}:streamGenerateContent\"].post.responses.default",
            "update": {
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/components/schemas/GenerateContentResponse"
                            }
                        }
                    },
                    "text/event-stream": {
                        "schema": {
                            "$ref": "#/components/schemas/GenerateContentResponse"
                        }
                    }
                }
            }
        },
        {
            "target": "$.components.parameters.alt.schema.enum",
            "update": [
                "sse"
            ]
        },
        {
            "target": "$.components.schemas.Model.required",
            "remove": true
        },
        {
            "target": "$.components.schemas.Model",
            "update": {
                "required": [
                    "name",
                    "version"
                ]
            }
        },
        {
            "target": "$.paths",
            "update": {
                "/upload/v1beta/files": {
                    "parameters": [],
                    "post": {
                        "description": "",
                        "operationId": "postUploadV1BetaFiles",
                        "parameters": [
                            {
                                "description": "upload_id",
                                "in": "query",
                                "name": "upload_id",
                                "schema": {
                                    "example": "ABgVH8-nlN8xjYU-2m28TEvS1vW1NOIFKk0Xe3qeNB9jjeCtVF6h5xJJ_EBQzUQk8Jwwvu6uA-UroEQ073YiiRpmhuPCUCN_P2oDFxfCC_4toA",
                                    "type": "string"
                                }
                            },
                            {
                                "description": "upload_protocol",
                                "in": "query",
                                "name": "upload_protocol",
                                "schema": {
                                    "type": "string",
                                    "enum": [
                                        "resumable"
                                    ]
                                }
                            },
                            {
                                "description": "X-Goog-Upload-Command",
                                "in": "header",
                                "name": "X-Goog-Upload-Command",
                                "schema": {
                                    "type": "string",
                                    "enum": [
                                        "start",
                                        "upload, finalize"
                                    ]
                                }
                            },
                            {
                                "description": "X-Goog-Upload-Offset",
                                "in": "header",
                                "name": "X-Goog-Upload-Offset",
                                "schema": {
                                    "example": 0,
                                    "type": "integer"
                                }
                            },
                            {
                                "description": "X-Goog-Upload-Protocol",
                                "in": "header",
                                "name": "X-Goog-Upload-Protocol",
                                "schema": {
                                    "type": "string",
                                    "enum": [
                                        "resumable"
                                    ]
                                }
                            },
                            {
                                "description": "X-Goog-Upload-Header-Content-Length",
                                "in": "header",
                                "name": "X-Goog-Upload-Header-Content-Length",
                                "schema": {
                                    "type": "integer"
                                }
                            },
                            {
                                "description": "X-Goog-Upload-Header-Content-Type",
                                "in": "header",
                                "name": "X-Goog-Upload-Header-Content-Type",
                                "schema": {
                                    "type": "string",
                                    "enum": [
                                        "audio/mpeg",
                                        "audio/mp3",
                                        "audio/mp4",
                                        "audio/m4a",
                                        "audio/wav",
                                        "audio/webm",
                                        "audio/ogg",
                                        "audio/flac"
                                    ]
                                }
                            }
                        ],
                        "requestBody": {
                            "content": {
                                "application/json": {
                                    "example": {
                                        "file": {
                                            "mimeType": "audio/mpeg",
                                            "sizeBytes": 889389
                                        }
                                    },
                                    "schema": {
                                        "$ref": "#/components/schemas/CreateFileRequest"
                                    }
                                },
                                "application/octet-stream": {
                                    "schema": {
                                        "type": "string",
                                        "format": "binary"
                                    }
                                }
                            },
                            "required": true
                        },
                        "responses": {
                            "200": {
                                "content": {
                                    "text/plain": {
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "application/json": {
                                        "schema": {
                                            "$ref": "#/components/schemas/CreateFileResponse"
                                        }
                                    }
                                },
                                "description": "",
                                "headers": {
                                    "X-GUploader-UploadID": {
                                        "description": "Custom header X-GUploader-UploadID",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Chunk-Granularity": {
                                        "description": "Custom header X-Goog-Upload-Chunk-Granularity",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Control-URL": {
                                        "description": "Custom header X-Goog-Upload-Control-URL",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-Content-Type": {
                                        "description": "Custom header X-Goog-Upload-Header-Content-Type",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-Vary": {
                                        "description": "Custom header X-Goog-Upload-Header-Vary",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-X-Google-Backends": {
                                        "description": "Custom header X-Goog-Upload-Header-X-Google-Backends",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-X-Google-GFE-Backend-Request-Cost": {
                                        "description": "Custom header X-Goog-Upload-Header-X-Google-GFE-Backend-Request-Cost",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-X-Google-Security-Signals": {
                                        "description": "Custom header X-Goog-Upload-Header-X-Google-Security-Signals",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-X-Google-Session-Info": {
                                        "description": "Custom header X-Goog-Upload-Header-X-Google-Session-Info",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Header-x-google-esf-cloud-client-params": {
                                        "description": "Custom header X-Goog-Upload-Header-x-google-esf-cloud-client-params",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-Status": {
                                        "description": "Custom header X-Goog-Upload-Status",
                                        "schema": {
                                            "type": "string"
                                        }
                                    },
                                    "X-Goog-Upload-URL": {
                                        "description": "Custom header X-Goog-Upload-URL",
                                        "schema": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}